# Messaging: Kafka vs RabbitMQ

Выбор брокера сообщений для разных сценариев.

## Сводная таблица

| Поток / сценарий | Брокер | Тип сообщений | Обоснование |
|------------------|--------|---------------|-------------|
| PaymentCompleted -> Notifications | Kafka | Event | Много подписчиков, durability, порядок важен |
| PaymentCreated -> Anti-Fraud | Kafka | Event | Много подписчиков (Notifications, DWH, Core Banking, Anti-Fraud training) |
| Телеметрия/лог транзакций | Kafka | Event | Огромный объём данных, стриминговая аналитика |
| Очередь генерации отчётов | RabbitMQ | Command/Job | Один получатель, приоритеты, TTL |
| Callbacks retry | RabbitMQ | Command/Job | TTL + delayed retry |

## Kafka

Использовать когда:
- Много подписчиков на одно событие (1 топик вместо N очередей)
- Нужен durability — перечитать события при сбое консьюмера
- Важен порядок событий
- Большой объём данных (стриминговая аналитика)

## RabbitMQ

Использовать когда:
- Один получатель на задание
- Нужны приоритеты (срочные задания вперёд)
- TTL — устаревшие задания можно отбросить
- Delayed retry (отложенная повторная отправка)
- Не нужно хранить сообщения после ack
